"use strict";(self.webpackChunkbudgetbuddy_client=self.webpackChunkbudgetbuddy_client||[]).push([[630],{2630:(e,s,t)=>{t.r(s),t.d(s,{default:()=>u});var a=t(5043),n=t(3519),r=t(8155),i=t(1319),l=t(1072),c=t(8602),d=t(3814),o=t(5016),h=t(3216),m=t(7304),x=t(6058),g=t(9722),b=t(2145),j=t(579);m.t1.register(m.PP,m.kc,m.FN,m.No,m.E8,m.Bs,m.hE,m.m_,m.s$);const u=()=>{const{user:e}=(0,o.A)(),s=(0,h.Zp)(),[t,m]=(0,a.useState)(!0),[u,p]=(0,a.useState)({totalUsers:0,activeUsers:0,inactiveUsers:0,newUsersThisMonth:0,registrationData:[],loginData:[],activityData:[]}),[v,A]=(0,a.useState)("month"),[y,N]=(0,a.useState)((new Date).getMonth()),[w,D]=(0,a.useState)((new Date).getFullYear());(0,a.useEffect)(()=>{e&&"admin"!==e.role&&(b.oR.error("Access denied. Admin only."),s("/dashboard"))},[e,s]),(0,a.useEffect)(()=>{f()},[v,y,w]);const f=async()=>{try{m(!0);const e=localStorage.getItem("token"),s=(await g.A.get("".concat("https://budget-buddy-h1k2.onrender.com/api","/admin/users"),{headers:{Authorization:"Bearer ".concat(e)}})).data.data.users,t=new Date,a=new Date(w,y,1),n=new Date(w,y+1,0);let r=s;"month"===v&&(r=s.filter(e=>{const s=new Date(e.createdAt);return s>=a&&s<=n}));const i=new Date(t.getTime()-2592e6),l=s.filter(e=>(e.lastLogin?new Date(e.lastLogin):new Date(e.createdAt))>=i),c=U(s,v,y,w),d=k(s,v),o=M(s);p({totalUsers:s.length,activeUsers:l.length,inactiveUsers:s.length-l.length,newUsersThisMonth:r.length,registrationData:c,loginData:d,activityData:o})}catch(e){console.error("Error fetching stats:",e),b.oR.error("Failed to load statistics")}finally{m(!1)}},U=(e,s,t,a)=>{const n={};if("month"===s){const s=new Date(a,t+1,0).getDate();for(let e=1;e<=s;e++)n[e]=0;return e.forEach(e=>{const s=new Date(e.createdAt);if(s.getMonth()===t&&s.getFullYear()===a){const e=s.getDate();n[e]=(n[e]||0)+1}}),{labels:Object.keys(n).map(e=>"Day ".concat(e)),datasets:[{label:"New Registrations",data:Object.values(n),borderColor:"rgb(147, 51, 234)",backgroundColor:"rgba(147, 51, 234, 0.5)",tension:.4}]}}if("year"===s){const s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return s.forEach((e,s)=>n[s]=0),e.forEach(e=>{const s=new Date(e.createdAt);if(s.getFullYear()===a){const e=s.getMonth();n[e]=(n[e]||0)+1}}),{labels:s,datasets:[{label:"New Registrations",data:Object.values(n),borderColor:"rgb(147, 51, 234)",backgroundColor:"rgba(147, 51, 234, 0.5)",tension:.4}]}}return e.forEach(e=>{const s=new Date(e.createdAt),t="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0"));n[t]=(n[t]||0)+1}),{labels:Object.keys(n).sort(),datasets:[{label:"New Registrations",data:Object.values(n),borderColor:"rgb(147, 51, 234)",backgroundColor:"rgba(147, 51, 234, 0.5)",tension:.4}]}},k=e=>{const s={Daily:0,Weekly:0,Monthly:0,Rarely:0},t=new Date;return e.forEach(e=>{const a=e.lastLogin?new Date(e.lastLogin):new Date(e.createdAt),n=(t-a)/864e5;n<1?s.Daily++:n<7?s.Weekly++:n<30?s.Monthly++:s.Rarely++}),{labels:Object.keys(s),datasets:[{label:"User Activity",data:Object.values(s),backgroundColor:["rgba(147, 51, 234, 0.8)","rgba(168, 85, 247, 0.8)","rgba(192, 132, 252, 0.8)","rgba(216, 180, 254, 0.8)"],borderColor:["rgb(147, 51, 234)","rgb(168, 85, 247)","rgb(192, 132, 252)","rgb(216, 180, 254)"],borderWidth:2}]}},M=e=>{const s=new Date,t=new Date(s.getTime()-2592e6),a=e.filter(e=>(e.lastLogin?new Date(e.lastLogin):new Date(e.createdAt))>=t).length;return{labels:["Active (30 days)","Inactive"],datasets:[{data:[a,e.length-a],backgroundColor:["rgba(34, 197, 94, 0.8)","rgba(239, 68, 68, 0.8)"],borderColor:["rgb(34, 197, 94)","rgb(239, 68, 68)"],borderWidth:2}]}},R=async()=>{try{b.oR.info("Generating PDF report...");const e="\n        <html>\n          <head>\n            <title>BudgetBuddy - Analytics Report</title>\n            <style>\n              body { font-family: Arial, sans-serif; padding: 40px; }\n              h1 { color: #9333ea; }\n              .stat-box { display: inline-block; margin: 20px; padding: 20px; border: 2px solid #9333ea; border-radius: 10px; }\n              .stat-number { font-size: 32px; font-weight: bold; color: #9333ea; }\n              .stat-label { font-size: 14px; color: #666; }\n              table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n              th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }\n              th { background-color: #9333ea; color: white; }\n            </style>\n          </head>\n          <body>\n            <h1>\ud83d\udcca BudgetBuddy Analytics Report</h1>\n            <p>Generated on: ".concat((new Date).toLocaleString(),'</p>\n            \n            <h2>Key Metrics</h2>\n            <div class="stat-box">\n              <div class="stat-number">').concat(u.totalUsers,'</div>\n              <div class="stat-label">Total Users</div>\n            </div>\n            <div class="stat-box">\n              <div class="stat-number">').concat(u.activeUsers,'</div>\n              <div class="stat-label">Active Users</div>\n            </div>\n            <div class="stat-box">\n              <div class="stat-number">').concat(u.newUsersThisMonth,'</div>\n              <div class="stat-label">New This Month</div>\n            </div>\n            \n            <h2>User Growth Summary</h2>\n            <p>Active users represent ').concat((u.activeUsers/u.totalUsers*100).toFixed(1),"% of total user base.</p>\n            <p>Company shows ").concat(u.newUsersThisMonth>0?"positive":"stable",' growth trend.</p>\n            \n            <p style="margin-top: 60px; color: #666; font-size: 12px;">\n              This report is generated by BudgetBuddy Admin Dashboard<br>\n              \xa9 ').concat((new Date).getFullYear()," BudgetBuddy. All rights reserved.\n            </p>\n          </body>\n        </html>\n      "),s=window.open("","_blank");s.document.write(e),s.document.close(),s.print(),b.oR.success("Report ready for printing!")}catch(e){console.error("Error generating report:",e),b.oR.error("Failed to generate report")}},C={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}};return t?(0,j.jsx)(n.A,{className:"admin-dashboard mt-5",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("div",{className:"spinner-border text-purple",role:"status",children:(0,j.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,j.jsx)("p",{className:"mt-3",children:"Loading analytics..."})]})}):(0,j.jsxs)(n.A,{className:"admin-dashboard",fluid:!0,children:[(0,j.jsxs)("div",{className:"dashboard-header",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h1",{children:"\ud83d\udcca Admin Analytics Dashboard"}),(0,j.jsx)("p",{className:"text-muted",children:"Company Growth & User Insights"})]}),(0,j.jsx)(r.A,{variant:"primary",onClick:R,className:"print-btn",children:"\ud83d\udda8\ufe0f Generate Report"})]}),(0,j.jsx)(i.A,{className:"mb-4 time-selector-card",children:(0,j.jsx)(i.A.Body,{children:(0,j.jsxs)(l.A,{className:"align-items-center",children:[(0,j.jsx)(c.A,{md:6,children:(0,j.jsxs)(d.A.Group,{children:[(0,j.jsx)(d.A.Label,{children:"Time Range"}),(0,j.jsxs)(d.A.Select,{value:v,onChange:e=>A(e.target.value),className:"form-control",children:[(0,j.jsx)("option",{value:"month",children:"This Month"}),(0,j.jsx)("option",{value:"year",children:"This Year"}),(0,j.jsx)("option",{value:"all",children:"All Time"})]})]})}),"month"===v&&(0,j.jsx)(c.A,{md:6,children:(0,j.jsxs)(d.A.Group,{children:[(0,j.jsx)(d.A.Label,{children:"Select Month"}),(0,j.jsxs)(l.A,{children:[(0,j.jsx)(c.A,{children:(0,j.jsx)(d.A.Select,{value:y,onChange:e=>N(parseInt(e.target.value)),children:["January","February","March","April","May","June","July","August","September","October","November","December"].map((e,s)=>(0,j.jsx)("option",{value:s,children:e},s))})}),(0,j.jsx)(c.A,{children:(0,j.jsx)(d.A.Select,{value:w,onChange:e=>D(parseInt(e.target.value)),children:[2023,2024,2025,2026].map(e=>(0,j.jsx)("option",{value:e,children:e},e))})})]})]})})]})})}),(0,j.jsxs)(l.A,{className:"mb-4",children:[(0,j.jsx)(c.A,{md:3,sm:6,className:"mb-3",children:(0,j.jsx)(i.A,{className:"stat-card stat-card-purple",children:(0,j.jsxs)(i.A.Body,{children:[(0,j.jsx)("div",{className:"stat-icon",children:"\ud83d\udc65"}),(0,j.jsx)("div",{className:"stat-number",children:u.totalUsers}),(0,j.jsx)("div",{className:"stat-label",children:"Total Users"})]})})}),(0,j.jsx)(c.A,{md:3,sm:6,className:"mb-3",children:(0,j.jsx)(i.A,{className:"stat-card stat-card-green",children:(0,j.jsxs)(i.A.Body,{children:[(0,j.jsx)("div",{className:"stat-icon",children:"\u2705"}),(0,j.jsx)("div",{className:"stat-number",children:u.activeUsers}),(0,j.jsx)("div",{className:"stat-label",children:"Active Users"}),(0,j.jsx)("small",{className:"text-muted",children:"Last 30 days"})]})})}),(0,j.jsx)(c.A,{md:3,sm:6,className:"mb-3",children:(0,j.jsx)(i.A,{className:"stat-card stat-card-blue",children:(0,j.jsxs)(i.A.Body,{children:[(0,j.jsx)("div",{className:"stat-icon",children:"\ud83d\udcc8"}),(0,j.jsx)("div",{className:"stat-number",children:u.newUsersThisMonth}),(0,j.jsx)("div",{className:"stat-label",children:"New Registrations"}),(0,j.jsx)("small",{className:"text-muted",children:"Selected period"})]})})}),(0,j.jsx)(c.A,{md:3,sm:6,className:"mb-3",children:(0,j.jsx)(i.A,{className:"stat-card stat-card-orange",children:(0,j.jsxs)(i.A.Body,{children:[(0,j.jsx)("div",{className:"stat-icon",children:"\ud83d\udca4"}),(0,j.jsx)("div",{className:"stat-number",children:u.inactiveUsers}),(0,j.jsx)("div",{className:"stat-label",children:"Inactive Users"}),(0,j.jsx)("small",{className:"text-muted",children:"30+ days"})]})})})]}),(0,j.jsxs)(l.A,{className:"mb-4",children:[(0,j.jsx)(c.A,{lg:8,className:"mb-3",children:(0,j.jsxs)(i.A,{className:"chart-card",children:[(0,j.jsxs)(i.A.Header,{children:[(0,j.jsx)("h5",{children:"\ud83d\udcca User Registration Trend"}),(0,j.jsx)("p",{className:"mb-0 text-muted",children:"New user signups over time"})]}),(0,j.jsx)(i.A.Body,{children:(0,j.jsx)("div",{style:{height:"300px"},children:(0,j.jsx)(x.N1,{data:u.registrationData,options:C})})})]})}),(0,j.jsx)(c.A,{lg:4,className:"mb-3",children:(0,j.jsxs)(i.A,{className:"chart-card",children:[(0,j.jsxs)(i.A.Header,{children:[(0,j.jsx)("h5",{children:"\ud83d\udc41\ufe0f User Activity Status"}),(0,j.jsx)("p",{className:"mb-0 text-muted",children:"Active vs Inactive"})]}),(0,j.jsx)(i.A.Body,{children:(0,j.jsx)("div",{style:{height:"300px"},children:(0,j.jsx)(x.Fq,{data:u.activityData,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})})]})})]}),(0,j.jsxs)(l.A,{className:"mb-4",children:[(0,j.jsx)(c.A,{lg:6,className:"mb-3",children:(0,j.jsxs)(i.A,{className:"chart-card",children:[(0,j.jsxs)(i.A.Header,{children:[(0,j.jsx)("h5",{children:"\ud83d\udd04 Login Frequency Distribution"}),(0,j.jsx)("p",{className:"mb-0 text-muted",children:"How often users visit"})]}),(0,j.jsx)(i.A.Body,{children:(0,j.jsx)("div",{style:{height:"300px"},children:(0,j.jsx)(x.yP,{data:u.loginData,options:C})})})]})}),(0,j.jsx)(c.A,{lg:6,className:"mb-3",children:(0,j.jsxs)(i.A,{className:"chart-card insight-card",children:[(0,j.jsx)(i.A.Header,{children:(0,j.jsx)("h5",{children:"\ud83d\udca1 Key Insights"})}),(0,j.jsxs)(i.A.Body,{children:[(0,j.jsxs)("div",{className:"insight-item",children:[(0,j.jsx)("div",{className:"insight-icon",children:"\ud83d\udcc8"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h6",{children:"User Engagement"}),(0,j.jsxs)("p",{children:[(u.activeUsers/u.totalUsers*100).toFixed(1),"% of users are actively using the platform"]})]})]}),(0,j.jsxs)("div",{className:"insight-item",children:[(0,j.jsx)("div",{className:"insight-icon",children:"\ud83c\udfaf"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h6",{children:"Growth Rate"}),(0,j.jsxs)("p",{children:[u.newUsersThisMonth," new registrations in selected period"]})]})]}),(0,j.jsxs)("div",{className:"insight-item",children:[(0,j.jsx)("div",{className:"insight-icon",children:"\u2b50"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h6",{children:"Platform Health"}),(0,j.jsx)("p",{children:u.inactiveUsers<u.activeUsers?"Strong user retention and engagement":"Consider user re-engagement campaigns"})]})]}),(0,j.jsxs)("div",{className:"insight-item",children:[(0,j.jsx)("div",{className:"insight-icon",children:"\ud83d\ude80"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h6",{children:"Recommendation"}),(0,j.jsx)("p",{children:u.newUsersThisMonth>10?"Excellent growth! Maintain current strategies.":"Focus on user acquisition and marketing."})]})]})]})]})})]}),(0,j.jsx)(l.A,{children:(0,j.jsx)(c.A,{children:(0,j.jsx)(i.A,{className:"action-card",children:(0,j.jsxs)(i.A.Body,{children:[(0,j.jsx)("h5",{children:"\u26a1 Quick Actions"}),(0,j.jsxs)("div",{className:"action-buttons",children:[(0,j.jsx)(r.A,{variant:"outline-primary",onClick:()=>s("/admin/users"),children:"\ud83d\udc65 Manage Users"}),(0,j.jsx)(r.A,{variant:"outline-success",onClick:R,children:"\ud83d\udcc4 Export Report"}),(0,j.jsx)(r.A,{variant:"outline-info",onClick:f,children:"\ud83d\udd04 Refresh Data"})]})]})})})})]})}}}]);
//# sourceMappingURL=630.fd748621.chunk.js.map