"use strict";(self.webpackChunkbudgetbuddy_client=self.webpackChunkbudgetbuddy_client||[]).push([[978],{1978:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});var n=a(5043),s=a(4505),c=a(2145),o=a(5917),l=a(579);const r=()=>{const[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)(!0),[i,d]=(0,n.useState)("current-month"),[m,h]=(0,n.useState)((new Date).getMonth()+1),[x,u]=(0,n.useState)((new Date).getFullYear()),p=(0,n.useCallback)(async()=>{r(!0);try{if("all-time"===i){const e=(await s.FU.getAll()).data,a=e.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),n=e.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0),c=a-n,o={};e.filter(e=>"expense"===e.type).forEach(e=>{o[e.category]=(o[e.category]||0)+e.amount});const l=2e4,r=c,i=a>0?r/a*100:0,d=[];r>=l?d.push("Excellent! You saved \u20b9".concat(r.toFixed(2),", exceeding your goal by \u20b9").concat((r-l).toFixed(2))):r>0?d.push("You saved \u20b9".concat(r.toFixed(2)," (").concat(i.toFixed(1),"% of income)")):r<0&&d.push("Warning: You spent \u20b9".concat(Math.abs(r).toFixed(2)," more than you earned"));const m=Object.entries(o).sort((e,t)=>t[1]-e[1])[0];m&&d.push("Your highest expense category is ".concat(m[0]," (\u20b9").concat(m[1].toFixed(2),")")),t({period:{display:"All Time"},summary:{totalIncome:a,totalExpenses:n,balance:c,savingsGoal:l,savings:r,savingsPercentage:i},categoryBreakdown:o,insights:d,transactions:e,transactionCount:{income:e.filter(e=>"income"===e.type).length,expense:e.filter(e=>"expense"===e.type).length,total:e.length}})}else{const e=await s.Pt.getSummary({month:m,year:x});t(e.data)}}catch(e){c.oR.error("Failed to load summary"),console.error(e)}finally{r(!1)}},[i,m,x]);(0,n.useEffect)(()=>{p()},[p]);const j=async()=>{var t,a,n;const o="all-time"===i?"All Time":"".concat(new Date(2e3,m-1,1).toLocaleString("default",{month:"long"})," ").concat(x),l=(null===e||void 0===e||null===(t=e.transactionCount)||void 0===t?void 0:t.total)||0;if(window.confirm("\ud83d\udcca Export CSV Report\n\n"+"Period: ".concat(o,"\n")+"Transactions: ".concat(l,"\n")+"Income: \u20b9".concat(((null===e||void 0===e||null===(a=e.summary)||void 0===a?void 0:a.totalIncome)||0).toFixed(2),"\n")+"Expenses: \u20b9".concat(((null===e||void 0===e||null===(n=e.summary)||void 0===n?void 0:n.totalExpenses)||0).toFixed(2),"\n\n")+"Do you want to proceed with the export?"))try{if("all-time"===i){const e=await s.Pt.exportCSV({}),t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","transactions_all_time.csv"),document.body.appendChild(a),a.click(),a.remove()}else{const e=await s.Pt.exportCSV({month:m,year:x}),t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","transactions_".concat(m,"_").concat(x,".csv")),document.body.appendChild(a),a.click(),a.remove()}c.oR.success("CSV exported successfully")}catch(r){c.oR.error("Failed to export CSV"),console.error(r)}else c.oR.info("Export cancelled")},g=async()=>{var t,a,n;const o="all-time"===i?"All Time":"".concat(new Date(2e3,m-1,1).toLocaleString("default",{month:"long"})," ").concat(x),l=(null===e||void 0===e||null===(t=e.transactionCount)||void 0===t?void 0:t.total)||0;if(window.confirm("\ud83d\udcc4 Export PDF Report\n\n"+"Period: ".concat(o,"\n")+"Transactions: ".concat(l,"\n")+"Income: \u20b9".concat(((null===e||void 0===e||null===(a=e.summary)||void 0===a?void 0:a.totalIncome)||0).toFixed(2),"\n")+"Expenses: \u20b9".concat(((null===e||void 0===e||null===(n=e.summary)||void 0===n?void 0:n.totalExpenses)||0).toFixed(2),"\n\n")+"Do you want to proceed with the export?"))try{if("all-time"===i){const e=await s.Pt.exportPDF({}),t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","transactions_all_time.pdf"),document.body.appendChild(a),a.click(),a.remove()}else{const e=await s.Pt.exportPDF({month:m,year:x}),t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","transactions_".concat(m,"_").concat(x,".pdf")),document.body.appendChild(a),a.click(),a.remove()}c.oR.success("PDF exported successfully")}catch(r){c.oR.error("Failed to export PDF"),console.error(r)}else c.oR.info("Export cancelled")};if(a)return(0,l.jsx)("div",{className:"loading",children:(0,l.jsx)("div",{className:"spinner"})});if(!e)return(0,l.jsx)("div",{className:"container",children:"No data available"});const{totalIncome:y,totalExpenses:v,balance:b}=e.summary,{categoryBreakdown:N,insights:w,transactions:f=[]}=e;return(0,l.jsxs)("div",{className:"reports-page",children:[(0,l.jsxs)("div",{className:"page-header",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{children:"Financial Reports"}),(0,l.jsx)("p",{children:"View your financial summaries and export data"})]}),(0,l.jsxs)("div",{className:"view-toggle",children:[(0,l.jsx)("button",{className:"toggle-btn ".concat("current-month"===i?"active":""),onClick:()=>d("current-month"),children:"\ud83d\udcc5 This Month"}),(0,l.jsx)("button",{className:"toggle-btn ".concat("all-time"===i?"active":""),onClick:()=>d("all-time"),children:"\ud83c\udf0d All Time"})]})]}),"current-month"===i&&(0,l.jsx)("div",{className:"card mb-4",children:(0,l.jsxs)("div",{className:"period-selector",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Month"}),(0,l.jsx)("select",{value:m,onChange:e=>h(parseInt(e.target.value)),className:"form-select",children:Array.from({length:12},(e,t)=>(0,l.jsx)("option",{value:t+1,children:new Date(2e3,t,1).toLocaleString("default",{month:"long"})},t+1))})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Year"}),(0,l.jsx)("select",{value:x,onChange:e=>u(parseInt(e.target.value)),className:"form-select",children:Array.from({length:5},(e,t)=>{const a=(new Date).getFullYear()-t;return(0,l.jsx)("option",{value:a,children:a},a)})})]}),(0,l.jsxs)("div",{className:"export-buttons",children:[(0,l.jsx)("button",{className:"btn btn-outline",onClick:j,children:"\ud83d\udcca Export CSV"}),(0,l.jsx)("button",{className:"btn btn-outline",onClick:g,children:"\ud83d\udcc4 Export PDF"})]})]})}),"all-time"===i&&(0,l.jsx)("div",{className:"card mb-4",children:(0,l.jsxs)("div",{className:"export-buttons-fullwidth",children:[(0,l.jsx)("button",{className:"btn btn-outline",onClick:j,children:"\ud83d\udcca Export CSV (All Time)"}),(0,l.jsx)("button",{className:"btn btn-outline",onClick:g,children:"\ud83d\udcc4 Export PDF (All Time)"})]})}),(0,l.jsxs)("div",{className:"grid grid-3 mb-4",children:[(0,l.jsxs)("div",{className:"summary-card",children:[(0,l.jsx)("h3",{children:"Total Income"}),(0,l.jsxs)("p",{className:"amount income",children:["\u20b9",y.toFixed(2)]})]}),(0,l.jsxs)("div",{className:"summary-card",children:[(0,l.jsx)("h3",{children:"Total Expenses"}),(0,l.jsxs)("p",{className:"amount expense",children:["\u20b9",v.toFixed(2)]})]}),(0,l.jsxs)("div",{className:"summary-card",children:[(0,l.jsx)("h3",{children:"Net Balance"}),(0,l.jsxs)("p",{className:"amount ".concat(b>=0?"income":"expense"),children:["\u20b9",b.toFixed(2)]})]})]}),(0,l.jsxs)("div",{className:"card mb-4",children:[(0,l.jsx)("h3",{className:"card-title",children:"Expense Breakdown by Category"}),Object.keys(N).length>0?(0,l.jsx)("div",{className:"category-list",children:Object.entries(N).sort((e,t)=>t[1]-e[1]).map(e=>{let[t,a]=e;const n=(a/v*100).toFixed(1);return(0,l.jsxs)("div",{className:"category-item",children:[(0,l.jsxs)("div",{className:"category-header",children:[(0,l.jsx)("span",{className:"category-name",children:t}),(0,l.jsxs)("span",{className:"category-amount",children:["\u20b9",a.toFixed(2)]})]}),(0,l.jsx)("div",{className:"category-bar",children:(0,l.jsx)("div",{className:"category-fill",style:{width:"".concat(n,"%")}})}),(0,l.jsxs)("span",{className:"category-percentage",children:[n,"%"]})]},t)})}):(0,l.jsx)("p",{className:"text-center",children:"No expense data for this period"})]}),w.length>0&&(0,l.jsxs)("div",{className:"card mb-4",children:[(0,l.jsx)("h3",{className:"card-title",children:"\ud83d\udca1 Financial Insights"}),(0,l.jsx)("ul",{className:"insights-list",children:w.map((e,t)=>(0,l.jsx)("li",{children:e},t))})]}),(0,l.jsxs)("div",{className:"card transactions-section",children:[(0,l.jsxs)("div",{className:"section-header",children:[(0,l.jsx)("h3",{className:"card-title",children:"\ud83d\udccb Transaction Details"}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>window.print(),children:"\ud83d\udda8\ufe0f Print Report"})]}),f.length>0?(0,l.jsx)("div",{className:"table-responsive",children:(0,l.jsxs)("table",{className:"transactions-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Date"}),(0,l.jsx)("th",{children:"Type"}),(0,l.jsx)("th",{children:"Category"}),(0,l.jsx)("th",{children:"Amount"}),(0,l.jsx)("th",{children:"Note"})]})}),(0,l.jsx)("tbody",{children:f.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{children:[(0,l.jsx)("div",{children:(0,o.A)(new Date(e.date),"MMM dd, yyyy")}),(0,l.jsx)("div",{style:{fontSize:"12px",color:"#888"},children:(0,o.A)(new Date(e.date),"HH:mm")})]}),(0,l.jsx)("td",{children:(0,l.jsx)("span",{className:"badge ".concat(e.type),children:e.type})}),(0,l.jsx)("td",{children:e.category}),(0,l.jsxs)("td",{className:"amount ".concat(e.type),children:["income"===e.type?"+":"-","\u20b9",e.amount.toFixed(2)]}),(0,l.jsx)("td",{children:e.note||"-"})]},e._id))}),(0,l.jsxs)("tfoot",{children:[(0,l.jsxs)("tr",{className:"total-row",children:[(0,l.jsx)("td",{colspan:"3",children:(0,l.jsx)("strong",{children:"Total"})}),(0,l.jsx)("td",{children:(0,l.jsxs)("strong",{className:"amount income",children:["+\u20b9",y.toFixed(2)]})}),(0,l.jsx)("td",{})]}),(0,l.jsxs)("tr",{className:"total-row",children:[(0,l.jsx)("td",{colspan:"3",children:(0,l.jsx)("strong",{children:"Total Expenses"})}),(0,l.jsx)("td",{children:(0,l.jsxs)("strong",{className:"amount expense",children:["-\u20b9",v.toFixed(2)]})}),(0,l.jsx)("td",{})]}),(0,l.jsxs)("tr",{className:"total-row highlight",children:[(0,l.jsx)("td",{colspan:"3",children:(0,l.jsx)("strong",{children:"Net Balance"})}),(0,l.jsx)("td",{children:(0,l.jsxs)("strong",{className:"amount ".concat(b>=0?"income":"expense"),children:["\u20b9",b.toFixed(2)]})}),(0,l.jsx)("td",{})]})]})]})}):(0,l.jsx)("p",{className:"text-center",children:"No transactions for this period"})]})]})}}}]);
//# sourceMappingURL=978.1018ed2c.chunk.js.map